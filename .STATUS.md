# gRPC Debugger 專案現狀總結 (.STATUS.md)

本文件旨在提供專案目前的工作狀態、已解決的問題以及待辦事項，便於重新啟動對話時快速接軌。

---

## � 1. 核心修復進度 (Core Fixes)

### ✅ 已完成 (Resolved)
- **Protobuf 解碼核心重構**：已全面切換至 `@bufbuild/protobuf`，支援動態 Schema 註冊。
- **Registry 穩定性**：修復了 `createFileRegistry` 在 v2 API 下的相容性問題，實作了 `Functional Resolver` 降級機制，確保服務清單能穩定載入。
- **路徑後綴匹配 (Suffix Matching)**：解決了簡寫路徑 (如 `/admin.AdminService`) 無法查詢到全稱服務定義的問題。
- **gRPC-Web 傳輸優化**：
  - 支援 Gzip 壓縮解壓。
  - 修復 `common.Empty` (空訊息) 的解碼崩潰。
  - **Base64 智慧偵測**：解決了 `grpc-web-text` 的 `atob` 損壞與 `InvalidCharacterError`，現在程式會自動判斷資料是否需要二次 Base64 解碼。
- **UI 顯示優化**：
  - 移除 BigInt 的 `n` 字綴。
  - `$typeName` 移至灰字標籤，不影響 JSON 複製。
  - **Definition (Proto) 分頁**：現在能根據路徑精確顯示對應的欄位定義。
- **FileRegistry 穩定性**：實作拓撲排序確保依賴項正確載入，完全消除 `functional resolver fallback`。

---

## 🛠️ 2. 當前架構 (Current Architecture)

- **`src/lib/reflection-client.js`**：負責與 Server Reflection 通訊，建立 `FileRegistry`。
- **`src/lib/proto-engine.js`**：解碼核心，管理 `serviceMap` 並提供 `findMethod` (模糊匹配) 與 `decodeMessage`。
- **`src/stores/network.js`**：資料流中心，負責 `extractPayload` (處理 Framing、Base64、Gzip) 並觸發解碼。
- **`src/components/NetworkDetails.svelte`**：UI 詳情頁，與 `protoEngine` 配合顯示定義。

---

## � 3. 待辦事項 (Pending)

- [ ] **自動滾動 (Auto-scroll)**：確認封包清單在有新請求進入時能正確自動滾動。
- [ ] **更多內容類型支援**：目前主要針對 `application/grpc-web+proto` 與 `application/grpc-web-text`。
- [ ] **性能監控**：在大量解碼場景下的記憶體與 CPU 使用率驗證。

---

## 🔴 4. 剩餘已知小問題 (Known Issues)
- **暫無**：所有核心功能運作正常。

---
*上次更新時間：2025-12-22 14:55 (UTC+8)*
